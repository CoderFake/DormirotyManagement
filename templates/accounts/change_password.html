{% extends 'base.html' %}

{% block title %}Đổi mật khẩu - Quản lý Ký túc xá{% endblock %}

{% block content %}
<div class="container-fluid">
    <div class="row justify-content-center">
        <div class="col-lg-6">
            <div class="card shadow-sm mb-4">
                <div class="card-header">
                    <h5 class="card-title m-0">Đổi mật khẩu</h5>
                </div>
                <div class="card-body">
                    <form method="post" class="needs-validation" novalidate>
                        {% csrf_token %}

                        {% if form.non_field_errors %}
                            <div class="alert alert-danger" role="alert">
                                {% for error in form.non_field_errors %}
                                    {{ error }}
                                {% endfor %}
                            </div>
                        {% endif %}

                        <div class="mb-3">
                            <label for="{{ form.old_password.id_for_label }}" class="form-label">{{ form.old_password.label }}</label>
                            <div class="input-group">
                                {{ form.old_password }}
                                <button class="btn btn-outline-secondary show-password-toggle" type="button">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            {% if form.old_password.errors %}
                                <div class="invalid-feedback d-block">
                                    {% for error in form.old_password.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>

                        <div class="mb-3">
                            <label for="{{ form.new_password1.id_for_label }}" class="form-label">{{ form.new_password1.label }}</label>
                            <div class="input-group">
                                {{ form.new_password1 }}
                                <button class="btn btn-outline-secondary show-password-toggle" type="button">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            {% if form.new_password1.errors %}
                                <div class="invalid-feedback d-block">
                                    {% for error in form.new_password1.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% else %}
                                <div class="form-text">
                                    <ul class="mb-0">
                                        <li>Mật khẩu không được giống thông tin cá nhân của bạn.</li>
                                        <li>Mật khẩu phải chứa ít nhất 8 ký tự.</li>
                                        <li>Mật khẩu không được quá phổ biến.</li>
                                        <li>Mật khẩu không được chứa toàn số.</li>
                                    </ul>
                                </div>
                            {% endif %}
                        </div>

                        <div class="mb-3">
                            <label for="{{ form.new_password2.id_for_label }}" class="form-label">{{ form.new_password2.label }}</label>
                            <div class="input-group">
                                {{ form.new_password2 }}
                                <button class="btn btn-outline-secondary show-password-toggle" type="button">
                                    <i class="fas fa-eye"></i>
                                </button>
                            </div>
                            {% if form.new_password2.errors %}
                                <div class="invalid-feedback d-block">
                                    {% for error in form.new_password2.errors %}
                                        {{ error }}
                                    {% endfor %}
                                </div>
                            {% endif %}
                        </div>

                        <div class="d-flex justify-content-between mt-4">
                            <a href="{% url 'accounts:profile' %}" class="btn btn-outline-secondary">
                                <i class="fas fa-arrow-left me-1"></i> Quay lại
                            </a>
                            <button type="submit" class="btn btn-primary">
                                <i class="fas fa-key me-1"></i> Đổi mật khẩu
                            </button>
                        </div>
                    </form>
                </div>
            </div>

            <div class="alert alert-warning">
                <h5 class="alert-heading"><i class="fas fa-exclamation-triangle me-2"></i>Lưu ý quan trọng!</h5>
                <p>Sau khi đổi mật khẩu thành công, bạn vẫn sẽ được duy trì đăng nhập. Tuy nhiên, tất cả các thiết bị khác đã đăng nhập vào tài khoản của bạn sẽ bị đăng xuất.</p>
                <p class="mb-0">Vui lòng ghi nhớ mật khẩu mới của bạn để tránh việc quên mật khẩu.</p>
            </div>
        </div>
    </div>
</div>
{% endblock %}